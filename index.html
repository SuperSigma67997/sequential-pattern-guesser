<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Visual & Raven Pattern Trainer</title>

<style>
body {
  background: #0b0b0b;
  color: #eee;
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 30px;
}

button {
  padding: 10px 18px;
  margin: 6px;
  font-size: 16px;
  cursor: pointer;
}

.hidden { display: none; }

.grid {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin: 20px 0;
}

.matrix {
  display: grid;
  grid-template-columns: repeat(3, 70px);
  gap: 12px;
  justify-content: center;
  margin: 20px 0;
}

.box {
  width: 70px;
  height: 70px;
  border-radius: 10px;
  border: 3px solid #666;
  cursor: pointer;
  box-shadow: 0 0 8px rgba(255,255,255,0.2);
}

.instructions {
  max-width: 600px;
  margin: 10px auto 20px;
  color: #ccc;
  font-size: 14px;
}
</style>
</head>

<body>

<h1>Pattern Trainer</h1>

<button onclick="show('visual')">Visual Patterns</button>
<button onclick="show('raven')">Raven Matrices</button>

<hr>

<!-- ================= VISUAL ================= -->

<div id="visual">

<h2>Visual Patterns</h2>

<div class="instructions">
You are shown a sequence of colored squares following a visual rule
(color cycling or alternation).  
Choose the square that correctly completes the sequence.
</div>

<div class="grid" id="vis-seq"></div>
<div class="grid" id="vis-ans"></div>
<h3 id="vis-res"></h3>

</div>

<!-- ================= RAVEN ================= -->

<div id="raven" class="hidden">

<h2>Raven Matrix</h2>

<div class="instructions">
Each row follows a visual rule based on brightness progression.  
The bottom-right square is missing.  
Choose the option that best completes the matrix.
</div>

<div class="matrix" id="raven-matrix"></div>
<div class="grid" id="raven-answers"></div>
<h3 id="raven-res"></h3>

</div>

<script>
/* ================= NAV ================= */

function show(id){
  ["visual","raven"].forEach(x =>
    document.getElementById(x).classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

/* ================= VISUAL ================= */

let visCorrect = 0;

function genVisual(){
  document.getElementById("vis-res").textContent = "";

  const colors = ["#ff4d4d", "#4d79ff", "#4dff88", "#ffd24d"];
  const ruleType = Math.floor(Math.random() * 2);
  let rule;

  if(ruleType === 0){
    let start = Math.floor(Math.random() * colors.length);
    rule = i => colors[(start + i) % colors.length];
  } else {
    let a = colors[0], b = colors[1];
    rule = i => i % 2 === 0 ? a : b;
  }

  const seq = document.getElementById("vis-seq");
  seq.innerHTML = "";

  for(let i = 0; i < 4; i++){
    let box = document.createElement("div");
    box.className = "box";
    box.style.background = rule(i);
    seq.appendChild(box);
  }

  let q = document.createElement("div");
  q.className = "box";
  q.style.background = "#222";
  seq.appendChild(q);

  const ans = document.getElementById("vis-ans");
  ans.innerHTML = "";
  visCorrect = Math.floor(Math.random() * 4);

  for(let i = 0; i < 4; i++){
    let box = document.createElement("div");
    box.className = "box";
    box.style.background =
      i === visCorrect ? rule(4) : colors[Math.floor(Math.random()*colors.length)];
    box.onclick = () => checkVisual(i);
    ans.appendChild(box);
  }
}

function checkVisual(i){
  const res = document.getElementById("vis-res");
  if(i === visCorrect){
    res.textContent = "Correct ✅";
    setTimeout(genVisual, 1500);
  } else {
    res.textContent = "Wrong ❌";
  }
}

/* ================= RAVEN ================= */

let ravenCorrect = 0;

function genRaven(){
  document.getElementById("raven-res").textContent = "";

  const matrix = document.getElementById("raven-matrix");
  matrix.innerHTML = "";

  // brightness increases left → right, top → bottom
  let base = Math.floor(Math.random() * 3) + 1;
  let rule = i => 0.15 + (i * 0.07) + base * 0.05;

  for(let i = 0; i < 8; i++){
    let box = document.createElement("div");
    box.className = "box";
    box.style.background = `rgba(255,255,255,${rule(i)})`;
    matrix.appendChild(box);
  }

  let q = document.createElement("div");
  q.className = "box";
  q.style.background = "#222";
  matrix.appendChild(q);

  const ans = document.getElementById("raven-answers");
  ans.innerHTML = "";

  ravenCorrect = Math.floor(Math.random() * 4);

  for(let i = 0; i < 4; i++){
    let box = document.createElement("div");
    box.className = "box";

    let opacity = i === ravenCorrect
      ? rule(8)
      : rule(8) + (Math.random() * 0.12 - 0.06);

    box.style.background = `rgba(255,255,255,${opacity})`;
    box.onclick = () => checkRaven(i);
    ans.appendChild(box);
  }
}

function checkRaven(i){
  const res = document.getElementById("raven-res");
  if(i === ravenCorrect){
    res.textContent = "Correct ✅";
    setTimeout(genRaven, 1500);
  } else {
    res.textContent = "Wrong ❌";
  }
}

/* ================= INIT ================= */

genVisual();
genRaven();
</script>

</body>
</html>
